{
    "custom_packs": [
        {
            "id": "soc-microsoft-defender.zip",
            "url": "https://github.com/Palo-Cortex/soc-microsoft-defender/archive/refs/tags/v1.0.3.zip",
            "system": "yes"
        }
    ],
    "post_config_docs": [
        {
            "name": "SOC Microsoft Defender - Manual Steps",
            "url": "https://github.com/Palo-Cortex/soc-microsoft-defender/blob/main/POST_CONFIG_README.md"
        }
    ],
    "marketplace_packs": [
        {
            "id": "FeedOffice365",
            "name": "Office 365 Feed",
            "version": "latest"
        },
        {
            "id": "MicrosoftDefenderAdvancedThreatProtection",
            "name": "Microsoft Defender for Endpoint",
            "version": "latest"
        }
    ],
    "integration_instances": [
        {
            "version": 2,
            "propagationLabels": [
                "all"
            ],
            "isOverridable": false,
            "enabled": "true",
            "name": "TEST INSTANCE - Microsoft Defender Advanced Threat Protection",
            "brand": "Microsoft Defender Advanced Threat Protection",
            "category": "Endpoint",
            "engine": "",
            "engineGroup": "",
            "isIntegrationScript": true,
            "mappingId": "",
            "outgoingMapperId": "",
            "incomingMapperId": "Microsoft Defender For Endpoint Mapper",
            "canSample": true,
            "defaultIgnore": false,
            "integrationLogLevel": "",
            "configuration": {
                "id": "",
                "version": 0,
                "cacheVersn": 0,
                "modified": "0001-01-01T00:00:00Z",
                "sizeInBytes": 0,
                "packID": "",
                "packName": "",
                "itemVersion": "",
                "fromServerVersion": "",
                "toServerVersion": "",
                "definitionId": "",
                "isOverridable": false,
                "vcShouldIgnore": false,
                "vcShouldKeepItemLegacyProdMachine": false,
                "commitMessage": "",
                "shouldCommit": false,
                "name": "",
                "prevName": "",
                "display": "",
                "brand": "",
                "category": "",
                "icon": "",
                "description": "",
                "configuration": null,
                "integrationScript": null,
                "hidden": false,
                "canGetSamples": false
            },
            "data": [
                {
                    "section": "Connect",
                    "display": "Token",
                    "displayPassword": "",
                    "name": "_tenant_id",
                    "defaultValue": "",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": "default-fill-me-in"
                },
                {
                    "section": "Connect",
                    "display": "Incident type",
                    "displayPassword": "",
                    "name": "incidentType",
                    "defaultValue": "",
                    "type": 13,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Server URL (e.g., https://api.securitycenter.microsoft.com)",
                    "displayPassword": "",
                    "name": "url",
                    "defaultValue": "",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "More information can be found on https://cortex.marketplace.pan.dev/marketplace/details/MicrosoftDefenderAdvancedThreatProtection/",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Authentication Type",
                    "displayPassword": "",
                    "name": "auth_type",
                    "defaultValue": "Client Credentials",
                    "type": 15,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "Authorization Code",
                        "Client Credentials",
                        "Azure Managed Identities"
                    ],
                    "info": "Type of authentication - either Authorization Code (recommended) or Client Credentials.",
                    "hasvalue": true,
                    "value": "Client Credentials"
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Key (received from the admin consent - see Detailed Instructions (?) section) (Deprecated)",
                    "displayPassword": "",
                    "name": "enc_key",
                    "defaultValue": "",
                    "type": 4,
                    "required": false,
                    "hidden": true,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": ""
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "ID (received from the admin consent - see Detailed Instructions (?) section) (Deprecated)",
                    "displayPassword": "",
                    "name": "auth_id",
                    "defaultValue": "",
                    "type": 4,
                    "required": false,
                    "hidden": true,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": ""
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Endpoint Type",
                    "displayPassword": "",
                    "name": "endpoint_type",
                    "defaultValue": "Worldwide",
                    "type": 15,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "Worldwide",
                        "EU Geo Proximity",
                        "UK Geo Proximity",
                        "US Geo Proximity",
                        "US GCC",
                        "US GCC-High",
                        "DoD",
                        "Custom"
                    ],
                    "info": "When selecting the Custom option, the Server URL parameter must be filled. More information can be found on the integration page - https://xsoar.pan.dev/docs/reference/integrations/microsoft-defender-advanced-threat-protection",
                    "hasvalue": true,
                    "value": "Worldwide"
                },
                {
                    "section": "Connect",
                    "display": "",
                    "displayPassword": "Key",
                    "name": "credentials",
                    "defaultValue": "",
                    "type": 9,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": true,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Status for fetching alerts as incidents. Comma-separated lists are supported, e.g., New,Resolved.",
                    "displayPassword": "",
                    "name": "fetch_status",
                    "defaultValue": "New",
                    "type": 16,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "New",
                        "InProgress",
                        "Resolved"
                    ],
                    "info": "",
                    "hasvalue": true,
                    "value": [
                        "New"
                    ]
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Using Microsoft GCC? (Deprecated)",
                    "displayPassword": "",
                    "name": "is_gcc",
                    "defaultValue": "false",
                    "type": 8,
                    "required": false,
                    "hidden": true,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Connect",
                    "display": "",
                    "displayPassword": "Azure Managed Identities Client ID",
                    "name": "managed_identities_client_id",
                    "defaultValue": "",
                    "type": 9,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": true,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "The Managed Identities client ID for authentication - relevant only if the integration is running on Azure VM.",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Authorization code",
                    "displayPassword": "Authorization code",
                    "name": "auth_code",
                    "defaultValue": "",
                    "type": 9,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": true,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "for user-auth mode - received from the authorization step. see Detailed Instructions section",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Collect",
                    "display": "Maximum number of incidents to fetch",
                    "displayPassword": "",
                    "name": "max_fetch",
                    "defaultValue": "50",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": "50"
                },
                {
                    "section": "Connect",
                    "display": "Use a self-deployed Azure Application",
                    "displayPassword": "",
                    "name": "self_deployed",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "Select this checkbox if you are using a self-deployed Azure application.",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Connect",
                    "display": "ID",
                    "displayPassword": "",
                    "name": "_auth_id",
                    "defaultValue": "",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": "default-fill-me-in"
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Fetch alert evidence",
                    "displayPassword": "",
                    "name": "fetch_evidence",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Collect",
                    "display": "Fetch incidents",
                    "displayPassword": "",
                    "name": "isFetch",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Token (received from the admin consent - see Detailed Instructions (?) (Deprecated) section)",
                    "displayPassword": "",
                    "name": "tenant_id",
                    "defaultValue": "",
                    "type": 4,
                    "required": false,
                    "hidden": true,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": ""
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Source Reliability",
                    "displayPassword": "",
                    "name": "Reliability",
                    "defaultValue": "B - Usually reliable",
                    "type": 15,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "A+ - 3rd party enrichment",
                        "A - Completely reliable",
                        "B - Usually reliable",
                        "C - Fairly reliable",
                        "D - Not usually reliable",
                        "E - Unreliable",
                        "F - Reliability cannot be judged"
                    ],
                    "info": "Reliability of the source providing the intelligence data.",
                    "hasvalue": true,
                    "value": "B - Usually reliable"
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Use system proxy settings",
                    "displayPassword": "",
                    "name": "proxy",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "DetectionSource to filter out alerts for fetching as incidents.",
                    "displayPassword": "",
                    "name": "fetch_detectionsource",
                    "defaultValue": "",
                    "type": 16,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "Antivirus",
                        "Automated investigation",
                        "Custom detection",
                        "Custom TI",
                        "EDR",
                        "Microsoft 365 Defender",
                        "Microsoft Defender for Office 365",
                        "Microsoft Defender Experts",
                        "SmartScreen",
                        "Third-party sensors"
                    ],
                    "info": "",
                    "hasvalue": true,
                    "value": []
                },
                {
                    "section": "Collect",
                    "display": "First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)",
                    "displayPassword": "",
                    "name": "first_fetch_timestamp",
                    "defaultValue": "3 days",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": "3 days"
                },
                {
                    "section": "Collect",
                    "advanced": true,
                    "display": "Severity for fetching alerts as incidents. Comma-separated lists are supported, e.g., Medium,High.",
                    "displayPassword": "",
                    "name": "fetch_severity",
                    "defaultValue": "Informational,Low,Medium,High",
                    "type": 16,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": [
                        "Informational",
                        "Low",
                        "Medium",
                        "High"
                    ],
                    "info": "",
                    "hasvalue": true,
                    "value": [
                        "Informational",
                        "Low",
                        "Medium",
                        "High"
                    ]
                },
                {
                    "display": "Alerts Fetch Interval",
                    "displayPassword": "",
                    "name": "alertFetchInterval",
                    "defaultValue": "1",
                    "type": 19,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": "1"
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Certificate Thumbprint",
                    "displayPassword": "",
                    "name": "certificate_thumbprint",
                    "defaultValue": "",
                    "type": 4,
                    "required": false,
                    "hidden": true,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "Used for certificate authentication. As appears in the \"Certificates & secrets\" page of the app.",
                    "hasvalue": false,
                    "value": ""
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Application redirect URI (for authorization code mode)",
                    "displayPassword": "",
                    "name": "redirect_uri",
                    "defaultValue": "",
                    "type": 0,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": null
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Private Key",
                    "displayPassword": "",
                    "name": "private_key",
                    "defaultValue": "",
                    "type": 14,
                    "required": false,
                    "hidden": true,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "Used for certificate authentication. The private key of the registered certificate.",
                    "hasvalue": false,
                    "value": ""
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Trust any certificate (not secure)",
                    "displayPassword": "",
                    "name": "insecure",
                    "defaultValue": "",
                    "type": 8,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": true,
                    "value": false
                },
                {
                    "section": "Connect",
                    "advanced": true,
                    "display": "Certificate Thumbprint",
                    "displayPassword": "Private Key",
                    "name": "creds_certificate",
                    "defaultValue": "",
                    "type": 9,
                    "required": false,
                    "hidden": false,
                    "hiddenUsername": false,
                    "hiddenPassword": false,
                    "options": null,
                    "info": "",
                    "hasvalue": false,
                    "value": null
                }
            ],
            "passwordProtected": false
        }
    ]
}
